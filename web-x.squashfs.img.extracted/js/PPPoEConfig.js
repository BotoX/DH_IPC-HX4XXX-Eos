!function(a){define(function(require,a,b){b.exports=require("jsCore/pageTab")}),define("PPPoE",function(require,b,c){var d,e,f,g,h,i,j,k,l=require("jsCore/rpc"),m=require("jsCore/pageBase"),n=require("common/common").Check;c.exports=m.extend({init:function(){var b=this;d=b.$("#pppoe_enable"),e=b.$("#pppoe_username").textfield(),f=b.$("#pppoe_password").textfield(),g=a.validator([{element:e,check:[n.noQuotation,n.noQuotation],errorMsg:["w_noInputMarks","w_noInputMarks"],events:["keyup","blur"]},{element:f,check:[n.noQuotation,n.noQuotation],errorMsg:["w_noInputMarks","w_noInputMarks"],events:["keyup","blur"]}],function(a){a.parent().translation()}),b.render()},render:function(){this._getConfig()},_getConfig:function(a){var b=this;l.ConfigManager.getConfig("PPPoE").done(function(c){h=c,b._renderElement(),b.disabled("[btn-for=onSave]",!1),a&&b.tip("success","Operateingsuccess")}).fail(function(){b.disabled("[btn-for=onSave]",!0),b.tip("error","Operateingfailure")})},_renderElement:function(){var a=this;d.prop("checked",h.Enable),e.textfield("value",h.UserName),f.textfield("value",h.Password),g.validate(),a.$("#pppoe_ip").closest(".ui-form-item").hide(),clearInterval(i),h.Enable&&(j&&k?a._getRegistedIP(k):l.NetApp.getNetInterfaces().done(function(b){i=setInterval(function(){a._getRegistedIP(b[0].Name)},5e3),k=b[0].Name}))},_getRegistedIP:function(a){var b=this;l.NetApp.getDialInfo(a).done(function(a){a&&a.IPAddress&&(j=!0,b.$("#pppoe_ip").text(a.IPAddress).closest(".ui-form-item").show(),clearInterval(i))})},onSave:function(){var a=this;return g.isInvalid()?a.tip("warning",g.errors()[0].errorMsg):(h.Enable=d.prop("checked"),h.UserName=e.textfield("value"),h.Password=f.textfield("value"),l.ConfigManager.setConfig("PPPoE",h).done(function(){a._getConfig(),a.tip("success","Succeed in saving configure")}).fail(function(){a.tip("error","Saving failure")}),!1)},onRefresh:function(){var a=this;return a._getConfig(!0),!1},onDefault:function(){var a=this;return l.ConfigManager.getDefault("PPPoE").done(function(b){h=b,a._renderElement(),a.disabled("[btn-for=onSave]",!1),a.tip("success","Defaultsuccess")}).fail(function(){a.disabled("[btn-for=onSave]",!0),a.tip("error","Defaultfailure")}),!1}})})}(jQuery);