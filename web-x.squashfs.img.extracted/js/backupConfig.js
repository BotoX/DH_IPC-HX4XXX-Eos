!function(a){define(function(require,a,b){b.exports=require("jsCore/pageTab")}),define("backup",function(require,b,c){var d=require("jsCore/rpc"),e=require("jsCore/plugin"),f=require("common/common"),g=require("jsCore/pageBase"),h=null,i=["VideoInOptions","VideoColor","Encode","EncodeCrop","VideoWaterMark","VideoWidget","ChannelTitle","VideoEncodeROI","VideoInPreviewOptions","VideoInWhiteBalance","VideoInExposure","VideoInDenoise","VideoInDayNight","VideoInFocus","VideoInZoom","VideoInSharpness","VideoInColor","VideoInRotate","VideoImageControl","VideoInMode","VideoInDefog","VideoWidgetNumberStat","AudioInDenoise","VideoInBacklight","LDCorrection","OSDSysAbnormal","NetSerEncrypt","NetAbort","PPPoE","DDNS","AlarmServer","NTP","Email","WLan","Wireless","SIP","Mobile","T2UServer","SNMP","Bonjour","ARP&Ping","Qos","VideoAnalyseRule","VideoAnalyseGlobal","VideoAnalyseModule","UserGlobal","AroudWifiSearch","MotionDetect","BlindDetect","UnFocusDetect","LossDetect","Alarm","NetAlarm","AlarmOut","ExAlarmOut","IPConflict","NetAbort","StorageNotExist","StorageFailure","StorageLowSpace","StorageHealthAlarm","FlashLight","LoginFailureAlarm","ArmMode","AudioDetect","Sound","AudioInputVolume","AudioOutputVolume","TrafficSnapshot.Detector","TrafficSnapshot.OSD.OSDOrder","MovedDetect","SmartEncode","Record","Snap","RecordMode","SnapMode","RecordStoragePoint","NAS","MediaGlobal","Holiday","StorageGlobal","StorageGroup","Comm","Ptz","AutoMaintain","ATM","ATMSniffer","Locales","Lighting","VideoOut","PowerFault","MultiVideoSensor"],j=["HeatImagingThermometry","ThermometryRule","HeatImagingTemper","FireWarning","RadioDataInJpeg","PicInPic","HotColdSpotWarning","QuickFocusSchedule","CalibratePoints","VideoInFaceAutoExposure","VisualRadiometry","ThermoIntelliVideoFilter","TrackerPolicy","TrackerPolicySchedule","VideoImageControl","VideoInBacklight","VideoInIRExposure","LDCorrection","FlatFieldCorrection","ThermographyOptionScene","ThermographyColorScene","PresetThermographyBond","TemperatureDifferenceOSD","ThermographyVideoMode","ThermoAlgo","FaceRadiometry"],k=[];c.exports=g.extend({init:function(){h=this,k=-1!==webApp.DeviceType.indexOf("TPC")?i.concat(j):i},onImport:function(){return e.ShowSaveOrOpenDlg("openFile","",[{description:"Config Files (*.backup)",extensions:["backup"]}]).done(function(a){(-1===webApp.DeviceType.indexOf("TPC")||""!==a[0])&&h._importConfig(a[0],a[1])}),!1},onExport:function(){return e.ShowSaveOrOpenDlg("saveFile","DeviceConfig",[{description:"Config Files (*.backup)",extensions:["backup"]}]).done(function(a){""!==a[0]&&h._exportConfig(a[0],a[1])}),!1},_importConfig:function(b,c){h.tip("warning","w_waiting",-1);var g=[],i=[];e.ReadFile(c).done(function(b){try{if(a.each(JSON.parse(b),function(a,b){g.push(a),i.push(b)}),0===g.length)return h.tip("warning","No items which can be imported.");d.ConfigManager.setConfig(g,i).done(function(a){f.chkMutilCallRet(a)?(h.tip("success","Succeed in saving configure"),h.$("#bu_path").text(c)):h.tip("error","Saving failure")})}catch(e){h.tip("warning","Bad FileFormat!")}})},_exportConfig:function(b,c){if(/[\\\/\:\*\?\"\<\>\|]/g.test(b))return h.tip("error","File Name Invalid!");h.tip("warning","w_waiting",-1);try{d.ConfigManager.getConfig(k).done(function(b){var d={};a.each(b,function(a,b){b.result&&b.params&&b.params.table&&(d[k[a]]=b.params.table)}),e.WriteFile(JSON.stringify(d),"w+",c).done(function(a){-1===a?h.tip("error","w_No Write Right"):(h.tip("success","Operateingsuccess"),h.$("#bu_path").text(c))})}).fail(function(){h.tip("error","Operateingfailure")})}catch(f){h.tip("error","Operateingfailure")}}})})}(jQuery);