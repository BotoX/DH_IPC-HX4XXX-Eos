!function(a){define(function(require,a,b){b.exports=require("jsCore/pageTab")}),define("snmp",function(require,b,c){function d(a){return a=a||"",a.length>7}var e=require("jsCore/rpc"),f=require("jsCore/pageBase"),g=null,h=!1,i=null,j=null,k=null,l=null,m=null,n={},o=require("common/common"),p=o.Check;c.exports=f.extend({init:function(){g=this,k=g.$("#snmp_v1_enable"),l=g.$("#snmp_v2_enable"),m=g.$("[chk-for=onV3Enable]"),i=a.validator([{element:g.$("[cfg=ReadCommon]"),check:[p.alphaNumLine,p.alphaNumLine,p.require],errorMsg:["w_BadstringServerName","w_BadstringServerName","w_Need"],events:["keyup","blur","blur"]},{element:g.$("[cfg=WriteCommon]"),check:[p.alphaNumLine,p.alphaNumLine,p.require],errorMsg:["w_BadstringServerName","w_BadstringServerName","w_Need"],events:["keyup","blur","blur"]}],function(a){a.parent().translation()}),j=a.validator([{element:g.$("[cfg=User]"),check:[p.alphaNumUnderline,p.alphaNumUnderline],errorMsg:["w_Badstring","w_Badstring"],events:["keyup","blur"]},{element:g.$("[cfg=V3ReadEncryPwd]"),check:[p.noQuotation,p.noQuotation,d],errorMsg:["w_noInputMarks","w_noInputMarks","w_Badlengtsh"],events:["blur","keyup","blur"]},{element:g.$("[cfg=V3ReadAuthPwd]"),check:[p.noQuotation,p.noQuotation,d],errorMsg:["w_noInputMarks","w_noInputMarks","w_Badlengtsh"],events:["blur","keyup","blur"]},{element:g.$("[cfg=Password]"),check:[p.noQuotation,p.noQuotation,d],errorMsg:["w_noInputMarks","w_noInputMarks","w_Badlengtsh"],events:["blur","keyup","blur"]},{element:g.$("[cfg=V3RWEncryPwd]"),check:[p.noQuotation,p.noQuotation,d],errorMsg:["w_noInputMarks","w_noInputMarks","w_Badlengtsh"],events:["blur","keyup","blur"]}],function(a){a.parent().translation()}),g.$("[cfg=Port], [cfg=TrapPort]").numberfield({min:1,max:65535,allowDecimal:!1,allowNegative:!1}),g.$("[cfg=KeepAlivePeriod]").numberfield({min:60,max:300,allowDecimal:!1,allowNegative:!1}),e.MagicBox.getProductDefinition("SNMPKeepAlive").done(function(a){h=!1,g.$("#snmp_live").hide(),a&&(h=!0,g.$("#snmp_live").show())}).fail(function(){h=!1,g.$("#snmp_live").hide()}),g.bind(),g.render()},bind:function(){a("[cfg='V3ReadAuthPwd']").on("keyup",g.limitPassword),a("[cfg='V3ReadEncryPwd']").on("keyup",g.limitPassword),a("[cfg='Password']").on("keyup",g.limitPassword),a("[cfg='V3RWEncryPwd']").on("keyup",g.limitPassword)},limitPassword:function(){var b=a(this).val();(b.indexOf(" ")>=0||b.indexOf('"')>=0||b.indexOf("'")>=0||/[\u4E00-\u9FA5]/g.test(b))&&(a(this).parent().children("span").text(tl("w_noInputChMarksSpace")),a(this).parent().children("span").css({display:"inline"}),a(this).val(""))},onV3Enable:function(){m.is(":checked")?(g.$("#snmp_v3_table").show(),k.prop("checked",!1),l.prop("checked",!1),j.validate(),g.disabled("#snmp_v1_enable, #snmp_v2_enable")):(g.$("#snmp_v3_table").hide(),g.disabled("#snmp_v1_enable, #snmp_v2_enable",!1))},onKeepAlive:function(){g.$("[chk-for=onKeepAlive]").is(":checked")?g.$("#snmp_IntervalDiv").show():g.$("#snmp_IntervalDiv").hide()},render:function(){e.ConfigManager.getConfig("SNMP").done(function(a){n=a,g._renderElements()})},_renderElements:function(){k.prop("checked",n.V1Enable),l.prop("checked",n.V2Enable),g.$("[chk-for=onKeepAlive]").prop("checked",n.KeepAliveEnable),g.onKeepAlive(),a.each(g.$("[cfg]"),function(a,b){var c=g.$(b).attr("cfg");g.$(b).val(n[c])}),n.V3Enable?(g.$("#snmp_v3_table").show(),k.prop("checked",!1),l.prop("checked",!1),m.prop("checked",!0),g.disabled("#snmp_v1_enable, #snmp_v2_enable")):(g.$("#snmp_v3_table").hide(),m.prop("checked",!1),g.disabled("#snmp_v1_enable, #snmp_v2_enable",!1)),a.each(g.$("[id^=snmp_rd], [id^=snmp_rw], [id^=snmp_re], [id^=snmp_rwe]"),function(a,b){var c=g.$(b).attr("id").split("_");"rd"===c[1]?g.$(b).prop("checked",n.V3ReadAuthType===c[2]):"re"===c[1]?g.$(b).prop("checked",n.V3ReadEncryType===c[2]):"rwe"===c[1]?g.$(b).prop("checked",n.V3RWEncryType===c[2]):g.$(b).prop("checked",n.V3RWAuthType===c[2])}),i.validate(),n.V3Enable&&j.validate()},onDefault:function(){e.ConfigManager.getDefault("SNMP").done(function(a){n=a,g._renderElements(),g.tip("success","Defaultsuccess")}).fail(function(){g.tip("error","Defaultfailure")})},onRefresh:function(){e.ConfigManager.getConfig("SNMP").done(function(a){n=a,g._renderElements(),g.tip("success","Operateingsuccess")}).fail(function(){g.tip("error","Operateingfailure")})},onConfirm:function(){if(i.isInvalid())return g.tip("warning",i.errors()[0].errorMsg);if(""!=g.$("[cfg=TrapServer]").val()){if(!p.ip(g.$("[cfg=TrapServer]").val())&&!p.ipv6(g.$("[cfg=TrapServer]").val()))return g.tip("warning","w_TrapAddress");if(p.ip(g.$("[cfg=TrapServer]").val())){var b=g.$("[cfg=TrapServer]").val().split(".");if(127==b[0]||0==b[0]||b[0]>223||0==b[3]||b[3]>254)return g.tip("warning","w_TrapAddress")}}if(g.$("[cfg=Port]").val()==g.$("[cfg=TrapPort]").val())return g.tip("warning","w_sameport");if(a.each(g.$("[cfg]"),function(a,b){var c=g.$(b).attr("cfg");n[c]=c.indexOf("Port")>-1||"KeepAlivePeriod"===c?g.$(b).val()-0:g.$(b).val()}),n.V1Enable=k.is(":checked"),n.V2Enable=l.is(":checked"),n.V3Enable=m.is(":checked"),h&&(n.KeepAliveEnable=g.$("[chk-for=onKeepAlive]").is(":checked")),n.V3Enable){if(j.isInvalid())return g.tip("warning",j.errors()[0].errorMsg);if(0===g.$("[cfg=User]").val().trim().length||0===g.$("[cfg=V3ReadUser]").val().trim().length)return g.tip("warning","w_Need");if(!p.alphaNumUnderline(g.$("[cfg=User]").val())||!p.alphaNumUnderline(g.$("[cfg=V3ReadUser]").val()))return g.tip("warning","w_Badstring");if(!d(g.$("input[type=password]").val()))return g.tip("warning","w_Badlengtsh");if(a.each(g.$("[id^=snmp_rd], [id^=snmp_rw], [id^=snmp_re], [id^=snmp_rwe]"),function(a,b){var c=g.$(b).attr("id").split("_");g.$(b).is(":checked")&&("rd"===c[1]?n.V3ReadAuthType=c[2]:"re"===c[1]?n.V3ReadEncryType=c[2]:"rwe"===c[1]?n.V3RWEncryType=c[2]:n.V3RWAuthType=c[2])}),n.User===n.V3ReadUser)return g.tip("warning","w_Name cannot be the same!")}e.ConfigManager.setConfig("SNMP",n).done(function(){g.tip("success","Succeed in saving configure")}).fail(function(){g.tip("error","Saving failure")})}})})}(jQuery);