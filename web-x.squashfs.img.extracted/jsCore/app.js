!function(a){define(function(require,b,c){var d=require("jsCore/rpc"),e=require("common/common"),f=require("jsCore/ability"),g=e.Cookie,h=c.exports=function(){var b=this;b.CHANNEL_NUMBER=1,b.AUDIO_IN_NUMBER=0,b.AUDIO_OUT_NUMBER=0,b.ALARM_IN_NUMBER=0,b.ALARM_OUT_NUMBER=0,b.ALARM_PIR=!1,b.ALARM_FLASH=!1,b.VideoStandard="PAL",b.MaxExtraStream=1,b.IsLocalStore=!1,b.Is3G=!1,b.IsIPCIntel=!1,b.IsSDIntel=!1,b.Is4G=!1,b.WIFI=!1,b.HasPtz=!1,b.DeviceType=webCaps.deviceClass?webCaps.deviceClass+webCaps.deviceType:webCaps.deviceType,b.Vendor=webCaps.vendor,b.DeviceSubClass=webCaps.DeviceSubClass,b.VSPs=[],b.ProcessInfo="",b.EncryptInfo=null,b.DisplayMode=-1===b.DeviceType.indexOf("TPC")&&g.get("DHVideoWHMode")||"Adaptive Window",b.IsNewProtocol=!1,b.NotifyVersion="",b.GongAnDetect=!1,b.PresetID=0,b.EventCaps={},b.DefaultEvent={FlashEnable:!1,FlashLatch:!1,RecordEnable:!1,RecordLatch:!1,MailEnable:!1,SnapshotEnable:!1,PtzLinkEnable:!1,AlarmOutEnable:!1,AlarmOutLatch:!1,VoiceEnable:!1,MMSEnable:!1,ShowQuickFocus:!1},require.async("js/index.js",function(c){b.loginPage=new c({element:a("#login").translation()})})};h.prototype.$=a,h.prototype.getGlobalConfigs=function(){var b=this;a.getJSON("/RPC2_Notify_Method").done(function(a){b.NotifyVersion=a.NotifyMethod}),d.MagicBox.getSystemInfoNew().done(function(b){if(b&&b.SyncTime&&"PerLogin"===b.SyncTime.Strategy){var c=new Date,e=c.getFullYear()+"-"+a.pad(c.getMonth()+1,2)+"-"+a.pad(c.getDate(),2),f=a.pad(c.getHours(),2)+":"+a.pad(c.getMinutes(),2)+":"+a.pad(c.getSeconds(),2);d.Global.setCurrentTime(e+" "+f,5)}});var c=[];return c.push(f.get("ChannelNum")),c.push(f.get("AlarmIn")),c.push(f.get("AlarmOut")),c.push(f.is("AlarmPir")),c.push(f.get("MaxExtraStream")),c.push(f.get("IsLocalStore")),c.push(f.get("VideoStandard")),c.push(f.get("VSP")),c.push(f.get("ProcessInfo")),c.push(f.get("HasPtz")),c.push(f.get("AudioInputNum")),c.push(f.get("AudioOutputNum")),c.push(f.get("CameraSwitchComV")),c.push(f.is("3G")),c.push(f.is("4G")),c.push(f.get("EncryptInfo")),c.push(f.get("VSPs")),c.push(f.is("Flash")),c.push(f.get("VideoAnalyse")),c.push(f.get("SpecVer")),c.push(f.get("getPreset")),c.push(f.get("EventCaps")),a.when.apply(null,c).done(function(){var c=arguments;b.CHANNEL_NUMBER=c[0],b.ALARM_IN_NUMBER=c[1],b.ALARM_OUT_NUMBER=c[2],b.ALARM_PIR=c[3],b.MaxExtraStream=c[4]||1,b.IsLocalStore=c[5]||!1,b.VideoStandard=c[6]||"PAL",b.ProcessInfo=c[8].toUpperCase(),b.HasPtz=c[9]||!1,b.AUDIO_IN_NUMBER=c[10],b.AUDIO_OUT_NUMBER=c[11],b.IsNewProtocol="V3"===c[12]||-1!==b.DeviceType.indexOf("TPC")?!0:!1,b.Is3G=!!c[13],b.Is4G=!!c[14],b.EncryptInfo=c[15],a.isArray(c[16])?b.VSPs=c[16]:c[7]&&"none"!==c[7].toLowerCase()&&(b.VSPs=[c[7]]),b.ALARM_FLASH=c[17],b.IsIPCIntel=-1!==b.DeviceType.indexOf("IPC")&&c[18]&&c[18].Support,b.IsSDIntel=-1!==b.DeviceType.indexOf("SD")&&c[18]&&c[18].Support,b.IsSDTraficIntel=b.IsSDIntel&&c[18].SupportScenes&&-1!==c[18].SupportScenes.indexOf("Traffic"),b.GongAnDetect="GongAnDetect"===c[19]?!0:!1,b.PresetID=c[20],b.EventCaps=c[21],-1!==b.DeviceType.indexOf("TPC")&&(webCaps.is_show_mainStreamType=1,webCaps.is_new_IVSUI=1)})},h.prototype.isNeedReboot=function(b){if(a.isArray(b)){if(-1!==a.inArray("NeedReboot",b)||-1!==a.inArray("NeedRestart",b))return!0;for(var c=b.length-1;c>=0;c--)if(b[c]&&b[c].params&&a.isArray(b[c].params.options)&&(-1!==a.inArray("NeedRestart",b[c].params.options)||-1!==a.inArray("NeedReboot",b[c].params.options)))return!0}return!1},h.prototype.reboot=function(b,c){function e(){d.MagicBox.reboot(),setTimeout(function(){plugin.Reload()},11e3)}a.dialog({title:tl("w_Reboot Device"),content:'<i class="i-dialog-warn"></i><span class="u-dialog-context">'+tl(b)+"</span>",closeable:c?!0:!1,buttons:c?[{name:"Yes",callback:function(){this.close(),e()}},{name:"No",callback:function(){this.close()}}]:[],iconIndex:1}),c||e()},window.login=require("jsCore/rpcLogin"),window.plugin=require("jsCore/plugin"),window.rpc=d,window.ability=f,window.common=e})}(jQuery);